.PHONY: bglda-help
bglda-help:
	@echo 'bglda targets:'
	@echo '  bglda:           build optimized batch Gibbs algorithm for LDA'
	@echo '  bglda-fat:       copy dependencies to "$(BGLDA_PROJ_BLD_DIR)"'
	@echo '                   (for in-place invocation)'
	@echo '  bglda-install:   install bglda'
	@echo

BGLDA_LIB := $(BGLDA_PROJ_BLD_DIR)/bglda

BGLDA_PROJ_SRC_SOURCES := $(wildcard $(BGLDA_PROJ_SRC_DIR)/bglda/*) $(BGLDA_PROJ_SRC_DIR)/pylowl.pxd $(BGLDA_PROJ_SRC_DIR)/bglda_run
BGLDA_PROJ_BLD_SOURCES := $(patsubst $(BGLDA_PROJ_SRC_DIR)/%,$(BGLDA_PROJ_BLD_DIR)/%,$(BGLDA_PROJ_SRC_SOURCES))

$(BGLDA_LIB): $(BGLDA_PROJ_BLD_DIR)/setup.py $(BGLDA_PROJ_BLD_SOURCES) $(PYLOWL_LIB)
	cd $(BGLDA_PROJ_BLD_DIR) && $(PYTHON) setup.py build_ext --inplace

.PHONY: bglda
bglda: $(BGLDA_LIB)

.PHONY: bglda-fat
bglda-fat: $(BGLDA_LIB)
	cp $(LOWL_LIB) $(BGLDA_PROJ_BLD_DIR)/
	cp $(PYLOWL_LIB) $(BGLDA_PROJ_BLD_DIR)/

.PHONY: bglda-install
bglda-install: bglda-fat
	cd $(BGLDA_PROJ_BLD_DIR) && $(PYTHON) setup.py install $(DISTUTILS_INSTALL_FLAGS)
